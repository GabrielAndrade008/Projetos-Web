<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - animoVERSE</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* O CSS da página de auth está aqui dentro pois ela não usa o style.css principal */
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: #d1d5db; display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        .auth-container { width: 100%; max-width: 420px; background-color: #1f2937; padding: 40px; border-radius: 12px; border: 1px solid #374151; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); }
        .form-header { text-align: center; margin-bottom: 32px; }
        .form-header h1 { font-size: 1.8rem; font-weight: 700; color: #ffffff; margin-bottom: 8px; }
        .form-header h1 span { color: #6366f1; }
        .form-header p { color: #9ca3af; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-size: 0.9rem; font-weight: 500; color: #d1d5db; }
        .input-field { width: 100%; background-color: #374151; border: 1px solid #4b5563; border-radius: 8px; padding: 12px 16px; color: #ffffff; font-size: 1rem; transition: all 0.2s ease-in-out; }
        .input-field:focus { outline: none; border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3); }
        .submit-btn { width: 100%; padding: 12px; border: none; border-radius: 8px; background-color: #4f46e5; color: #ffffff; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s ease-in-out; }
        .submit-btn:hover { background-color: #4338ca; }
        .form-toggle { text-align: center; margin-top: 24px; font-size: 0.9rem; }
        .toggle-link { color: #818cf8; font-weight: 500; text-decoration: none; cursor: pointer; }
        .toggle-link:hover { text-decoration: underline; }
        .back-link { display: block; text-align: center; margin-top: 32px; color: #9ca3af; text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { color: #d1d5db; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="auth-container">
        <div id="login-form">
            <div class="form-header">
                <h1>Entrar no <span>animoVERSE</span></h1>
                <p>Bem-vindo de volta!</p>
            </div>
            <form id="loginForm">
                <div class="input-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" class="input-field" placeholder="voce@exemplo.com" required>
                </div>
                <div class="input-group">
                    <label for="login-password">Senha</label>
                    <input type="password" id="login-password" class="input-field" placeholder="••••••••" required>
                </div>
                <button type="submit" class="submit-btn">Entrar</button>
            </form>
            <p class="form-toggle">
                Não tem uma conta? <span id="show-register" class="toggle-link">Cadastre-se</span>
            </p>
        </div>
        <div id="register-form" class="hidden">
            <div class="form-header">
                <h1>Criar Conta no <span>animoVERSE</span></h1>
                <p>Junte-se à nossa comunidade de Animes.</p>
            </div>
            <form id="registerForm">
                <div class="input-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" class="input-field" placeholder="voce@exemplo.com" required>
                </div>
                <div class="input-group">
                    <label for="register-password">Senha</label>
                    <input type="password" id="register-password" class="input-field" placeholder="Crie uma senha forte" required>
                </div>
                <div class="input-group">
                    <label for="confirm-password">Confirmar Senha</label>
                    <input type="password" id="confirm-password" class="input-field" placeholder="Repita a senha" required>
                </div>
                <button type="submit" class="submit-btn">Criar Conta</button>
            </form>
            <p class="form-toggle">
                Já tem uma conta? <span id="show-login" class="toggle-link">Faça Login</span>
            </p>
        </div>
        <a href="index.html" class="back-link">← Voltar para a página inicial</a>
    </div>
    <script>
    
document.addEventListener('DOMContentLoaded', () => {
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const showRegisterLink = document.getElementById('show-register');
    const showLoginLink = document.getElementById('show-login');

    // alternar entre telas
    showRegisterLink.addEventListener('click', () => {
        loginForm.classList.add('hidden');
        registerForm.classList.remove('hidden');
    });
    showLoginLink.addEventListener('click', () => {
        registerForm.classList.add('hidden');
        loginForm.classList.remove('hidden');
    });

    // Se já estiver logado, redireciona
    const usuario = JSON.parse(localStorage.getItem("usuario"));
    if (usuario) window.location.href = "index.html";

    // Função para exibir mensagens
    function mostrarToast(mensagem, cor = "#4f46e5") {
        const toast = document.createElement("div");
        toast.textContent = mensagem;
        toast.style.position = "fixed";
        toast.style.bottom = "20px";
        toast.style.right = "20px";
        toast.style.background = cor;
        toast.style.color = "#fff";
        toast.style.padding = "10px 16px";
        toast.style.borderRadius = "8px";
        toast.style.zIndex = "100";
        toast.style.opacity = "0";
        toast.style.transition = "opacity 0.3s ease-in-out";
        document.body.appendChild(toast);
        setTimeout(() => toast.style.opacity = "1", 50);
        setTimeout(() => {
            toast.style.opacity = "0";
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }

    // Cadastro
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('register-email').value.trim();
        const senha = document.getElementById('register-password').value.trim();
        const confirmar = document.getElementById('confirm-password').value.trim();

        if (senha !== confirmar) {
            mostrarToast("As senhas não coincidem!", "#ef4444");
            return;
        }

        const nome = email.split("@")[0]; // nome simples com base no email

        try {
            const res = await fetch("http://localhost:3000/cadastro", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ nome, email, senha })
            });

            const data = await res.json();
            if (res.ok) {
                mostrarToast("Conta criada com sucesso!");
                setTimeout(() => window.location.href = "auth.html", 1200);
            } else {
                mostrarToast(data.erro || "Erro ao cadastrar!", "#ef4444");
            }
        } catch (err) {
            mostrarToast("Erro ao conectar com o servidor.", "#ef4444");
        }
    });

    // Login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('login-email').value.trim();
        const senha = document.getElementById('login-password').value.trim();

        try {
            const res = await fetch("http://localhost:3000/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, senha })
            });

            const data = await res.json();
            if (res.ok) {
                localStorage.setItem("usuario", JSON.stringify(data.usuario));
                mostrarToast("Login realizado com sucesso!");
                setTimeout(() => window.location.href = "index.html", 1200);
            } else {
                mostrarToast(data.erro || "Email ou senha incorretos!", "#ef4444");
            }
        } catch (err) {
            mostrarToast("Erro ao conectar com o servidor.", "#ef4444");
        }
    });
});
    </script>
</body>
</html>